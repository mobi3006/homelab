---
- block:
    - name: Install microk8s
      snap:
        name: microk8s
        state: present
        classic: yes

    - name: Add user to microk8s group
      user:
        name: "{{ current_user }}"
        groups: microk8s
        append: yes

    - name: Enable microk8s addons
      shell: |
        microk8s enable dns storage

    - name: configure .alias
      copy:
        src: files/alias.zsh
        dest: /home/{{ current_user }}/{{ oh_my_zsh_custom_folder }}/aliases-microk8s.zsh

  become: true